(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ac947e00"],{ba82:function(t,e,o){"use strict";o.r(e);var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"d-inline-flex bookmark--item-actions",on:{contextmenu:function(t){t.preventDefault()}}},[e("DropLinkPrevue",{attrs:{url:t.link,showButton:!0}},[e("template",{slot:"header"},[e("button",{directives:[{name:"tmf-tooltip",rawName:"v-tmf-tooltip",value:{content:"View Page Detail"},expression:"{\n          content: 'View Page Detail'\n        }"}],staticClass:"btn-control sm sq icon light",on:{click:function(e){return t.showLinkPrevue(t.bookmark)}}},[e("span",{domProps:{innerHTML:t._s(t.$internalIcons.eye)}})])])],2),!("hidePin"in t.componentData)&&t.$permissionHelper.checkPermission({permissionName:"bookmarkPin",collection:t.selectedCollection})?e("button",{directives:[{name:"tmf-tooltip",rawName:"v-tmf-tooltip",value:{content:`${t.bookmark.isPinned?"Pinned":"Pin"} ${4==t.bookmark.type?"Email":"Link"}`},expression:"{\n      content: `${bookmark.isPinned ? 'Pinned' : 'Pin'} ${\n        bookmark.type == 4 ? 'Email' : 'Link'\n      }`\n    }"}],staticClass:"btn-control sm sq icon",class:t.bookmark.isPinned?"green":"light",on:{click:function(e){t.pinBookmarkHandler(t.bookmarkWithImages())}}},[t.pinningBookmarkId&&t.pinningBookmarkId===t.bookmark.id?e("div",{staticClass:"loader"}):e("span",{staticClass:"rotate-icon-90-deg",domProps:{innerHTML:t._s(t.$internalIcons.pin)}})]):t._e(),e("button",{directives:[{name:"tmf-tooltip",rawName:"v-tmf-tooltip",value:{content:"View QR Code"},expression:"{\n      content: 'View QR Code'\n    }"}],staticClass:"btn-control sm sq icon light",on:{click:function(e){t.viewBookmarkQRCode(t.bookmarkWithImages())}}},[e("span",{domProps:{innerHTML:t._s(t.$internalIcons.qrCode)}})]),e("button",{directives:[{name:"tmf-tooltip",rawName:"v-tmf-tooltip",value:{content:"Copy "+(4==t.bookmark.type?"Email":"Link")},expression:"{\n      content: `Copy ${bookmark.type == 4 ? 'Email' : 'Link'}`\n    }"}],staticClass:"btn-control sm sq icon light",staticStyle:{"margin-right":"5px"},on:{click:function(e){t.copyBookmarkLink(t.bookmarkWithImages())}}},[e("span",{domProps:{innerHTML:t._s(t.$internalIcons.copy)}})]),e("TmfDropdown",[e("template",{slot:"header"},[e("button",{staticClass:"btn-control sm sq icon no-border"},[e("span",{domProps:{innerHTML:t._s(t.$internalIcons.ellipsis)}})])]),!("hidePin"in t.componentData)&&t.$permissionHelper.checkPermission({permissionName:"bookmarkPin",collection:t.selectedCollection})?e("div",{staticClass:"tmf-dropdown__menu__item",on:{click:function(e){t.pinBookmarkHandler(t.bookmarkWithImages())}}},[e("div",{staticClass:"tmf-dropdown__menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.pin)}}),e("div",{staticClass:"tmf-dropdown__menu__item__title"},[t._v(" "+t._s(t.bookmark.isPinned?"Unpin":"Pin")+" "+t._s(4==t.bookmark.type?"Email":"Link")+" ")])]):t._e(),[1,0].includes(t.bookmark.type)?e("div",{staticClass:"tmf-dropdown__menu__item",on:{click:function(e){return t.openLinkInNewTab(t.bookmark)}}},[e("div",{staticClass:"tmf-dropdown__menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.browser)}}),e("div",{staticClass:"tmf-dropdown__menu__item__title"},[t._v(" Open in Browser ")])]):t._e(),"chrome"===t.hostType&&[1,0].includes(t.bookmark.type)?e("div",{staticClass:"tmf-dropdown__menu__item",on:{click:function(e){return t.openLinkInNewTab(t.bookmark,"private")}}},[e("div",{staticClass:"tmf-dropdown__menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.privateBrowser)}}),e("div",{staticClass:"tmf-dropdown__menu__item__title"},[t._v(" Open in Private Browser ")])]):t._e(),4==t.bookmark.type?e("div",{staticClass:"tmf-dropdown__menu__item",on:{click:function(e){return t.openEmailInNewTab(t.bookmark)}}},[e("div",{staticClass:"tmf-dropdown__menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.email)}}),e("div",{staticClass:"tmf-dropdown__menu__item__title"},[t._v(" Open in Email ")])]):t._e(),e("div",{staticClass:"tmf-dropdown__menu__item",on:{click:function(e){t.copyBookmarkLink(t.bookmarkWithImages())}}},[e("div",{staticClass:"tmf-dropdown__menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.copy)}}),e("div",{staticClass:"tmf-dropdown__menu__item__title"},[t._v(" Copy "+t._s(4==t.bookmark.type?"Email":"Link")+" ")])]),e("div",{staticClass:"tmf-dropdown__menu__item",on:{click:function(e){t.viewBookmarkQRCode(t.bookmarkWithImages())}}},[e("div",{staticClass:"tmf-dropdown__menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.qrCode)}}),e("div",{staticClass:"tmf-dropdown__menu__item__title"},[t._v(" View QR Code ")])]),!("hideEdit"in t.componentData)&&t.$permissionHelper.checkPermission({permissionName:"bookmarkEdit",collection:t.selectedCollection})?e("div",{staticClass:"tmf-dropdown__menu__item",on:{click:function(e){t.editBookmark(t.bookmarkWithImages())}}},[e("div",{staticClass:"tmf-dropdown__menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.pencil)}}),e("div",{staticClass:"tmf-dropdown__menu__item__title"},[t._v(" Edit ")])]):t._e(),!("hideEdit"in t.componentData)&&t.$permissionHelper.checkPermission({permissionName:"bookmarkTag",collection:t.selectedCollection})?e("div",{staticClass:"tmf-dropdown__menu__item",on:{click:function(e){return t.checkForLinkTag(t.bookmark,t.index)}}},[e("div",{staticClass:"tmf-dropdown__menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.tags)}}),e("div",{staticClass:"tmf-dropdown__menu__item__title"},[t._v(" Add Tag ")])]):t._e(),!("hideTrash"in t.componentData)&&t.$permissionHelper.checkPermission({permissionName:"bookmarkRemove",collection:t.selectedCollection})?e("div",{staticClass:"tmf-dropdown__menu__item",on:{click:function(e){return t.trashBookmark(t.bookmark,t.index)}}},[e("div",{staticClass:"tmf-dropdown__menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.trash)}}),e("div",{staticClass:"tmf-dropdown__menu__item__title"},[t._v(" Remove / Trash ")])]):t._e(),"showDelete"in t.componentData?e("div",{staticClass:"tmf-dropdown__menu__item",on:{click:function(e){return t.untrashBookmark(t.bookmark,t.index)}}},[e("div",{staticClass:"tmf-dropdown__menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.untrash)}}),e("div",{staticClass:"tmf-dropdown__menu__item__title"},[t._v(" Untrash / Restore ")])]):t._e(),"showDelete"in t.componentData?e("div",{staticClass:"tmf-dropdown__menu__item",on:{click:function(e){return t.deleteBookmark(t.bookmark,t.index)}}},[e("div",{staticClass:"tmf-dropdown__menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.trash)}}),e("div",{staticClass:"tmf-dropdown__menu__item__title"},[t._v(" Remove / Delete ")])]):t._e(),"outlook"===t.hostType&&"OutlookCompose"===t.$route.matched[0].name?e("div",{staticClass:"tmf-dropdown__menu__item",on:{click:function(e){return t.insertIntoEmail(t.bookmark,t.index)}}},[e("div",{staticClass:"tmf-dropdown__menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.emailLink)}}),e("div",{staticClass:"tmf-dropdown__menu__item__title"},[t._v(" Insert into email ")])]):t._e(),"outlook"===t.hostType&&"OutlookCompose"===t.$route.matched[0].name?e("div",{staticClass:"tmf-dropdown__menu__item",on:{click:function(e){return t.insertHyperlink(t.bookmark,t.index)}}},[e("div",{staticClass:"tmf-dropdown__menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.hyperlink)}}),e("div",{staticClass:"tmf-dropdown__menu__item__title"},[t._v(" Insert Hyperlink ")])]):t._e(),"TeamsExtension"===t.$route.matched[0].name?e("div",{staticClass:"tmf-dropdown__menu__item",on:{click:function(e){return t.insertIntoTeamsChat(t.bookmark,t.index)}}},[e("div",{staticClass:"tmf-dropdown__menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.addToChat)}}),e("div",{staticClass:"tmf-dropdown__menu__item__title"},[t._v(" Insert into chat ")])]):t._e(),"word"===t.hostType?e("div",{staticClass:"tmf-dropdown__menu__item",on:{click:function(e){return t.insertIntoWrodDocument(t.bookmark)}}},[e("div",{staticClass:"tmf-dropdown__menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.agreement)}}),e("div",{staticClass:"tmf-dropdown__menu__item__title"},[t._v(" Insert into document ")])]):t._e(),"word"===t.hostType&&t.wordDocumentSelectedRange.length?e("div",{staticClass:"tmf-dropdown__menu__item",on:{click:function(e){return t.insertIntoWrodDocument(t.bookmark,"hyperlink")}}},[e("div",{staticClass:"tmf-dropdown__menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.hyperlink)}}),e("div",{staticClass:"tmf-dropdown__menu__item__title"},[t._v(" Insert into document as Hyperlink ")])]):t._e()],2)],1)},i=[],s=o("e687"),a=o("2f62"),r={mixins:[s["a"]],props:{componentData:{type:Object,required:!1,default:()=>({})},bookmark:{type:Object,required:!0},bookmarksImagesOnly:{type:Array,required:!0},index:{type:Number,required:!0}},data(){return{pinningBookmarkId:null,link:""}},computed:{...Object(a["b"])(["hostType","wordDocumentSelectedRange","selectedCollection"])},components:{DropLinkPrevue:()=>o.e("chunk-63aed695").then(o.bind(null,"db6d"))},methods:{showLinkPrevue(t){this.link=t.path},bookmarkWithImages(){const t=this.bookmarksImagesOnly.find(t=>t.id===this.bookmark.id);return this.bookmark.icon=t.icon,this.bookmark}}},m=r,c=o("2877"),l=Object(c["a"])(m,n,i,!1,null,null,null);e["default"]=l.exports},e687:function(t,e,o){"use strict";var n=o("2f62");e["a"]={computed:{...Object(n["b"])(["searchedBookmarks","wordDocumentSelectedRange","selectedCollection","bookmarks"])},methods:{openLinkInNewTab(t,e="current"){if("current"===e)window.open(t.path,"_blank");else if("private"===e){let e=this.$store.getters.extensionId;if(!e)return;window.chrome.windows.create({url:t.path,incognito:!0})}},openEmailInNewTab(t){window.open("mailto:"+t.path)},copyLinkHandler(t){this.$bus.$emit("copy-bookmark",[t.id])},copyBookmarkLink(t){const e=document.createElement("textarea");e.value=t.path,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),this.$bus.$emit("open-toaster","Link copied")},viewBookmarkQRCode(t){this.$bus.$emit("open-qr-modal",t.path)},editBookmark(t){this.$bus.$emit("open-bookmark-form",t)},checkForLinkTag(t,e){this.$parent.$refs["link-tag-"+t.id][0].initialize({bookmark:t,index:e,storeInfo:this.componentData})},async trashBookmark(t){this.$bus.$emit("dialog-open",`Do you want to move <b>${t.title}</b> Link to trash?`),this.$bus.$on("dialog-success",e=>{e&&this.trashBookmarkApi(t),this.$bus.$off("dialog-success")})},async trashBookmarkApi(t){var e,o;let n=this,i={...t,isDeleted:!0,Type:1,title:t.title,description:t.description};this.$bus.$emit("open-toaster",`<small>Trashing Link <strong>${t.title}</strong></small>`,"loader");let s={};if(await n.$axios.put("/bookmark/"+t.id,i).then(e=>{s=e,this.$bus.$emit("open-toaster",`<b>Link Trashed</b> <small><strong>${t.title}</strong> link has been added to trash.</small>`,"success")}).catch(()=>{this.$bus.$emit("open-toaster",`<b>Error Trashing</b> <small><strong>${t.title}</strong> failed to trash.</small>`,"error")}),null!==t&&void 0!==t&&t.isSearch){let e=this.searchedBookmarks.filter(({...e})=>e.id!==t.id);this.$store.commit("SET_SEARCHED_BOOKMARKS",e)}else if(null!==t&&void 0!==t&&t.isSearch||+(null===(e=this.$route.params)||void 0===e?void 0:e.collectionId)!==(null===t||void 0===t?void 0:t.categoryID)){if(null!==(o=this.$route.meta)&&void 0!==o&&o.allBookmarks){let e=this.bookmarks.filter(({...e})=>e.id!==t.id);this.$store.commit("SET_BOOKMARKS",e)}}else{let t=this.selectedCollection;t.bookmarkCount-=1,this.$collectionHelper.mapCollection({collection:t,componentData:this.$collectionHelper.getNavItemComponentData(t),type:"update"})}this.$helper.setState("delete",this.componentData.mutation,this.componentData.getter,s.data,null,this.componentData.mutationImage,this.componentData.getterImage),this.$helper.setState("add","SET_TRASHED_BOOKMARKS","trashedBookmarks",s.data,null,this.componentData.mutationImage,this.componentData.getterImage)},async untrashBookmark(t){this.$bus.$emit("dialog-open",`Do you want to untrash ${t.title} Link?`),this.$bus.$on("dialog-success",e=>{e&&this.untrashBookmarkApi(t),this.$bus.$off("dialog-success")})},async untrashBookmarkApi(t){let e={...t,isDeleted:!1,Type:1,title:t.title,description:t.description},o=await this.$axios.put("/bookmark/"+t.id,e);this.$bus.$emit("open-toaster",`<b>${t.title}</b> bookmark moved from trash.`),this.$helper.setState("delete",this.componentData.mutation,this.componentData.getter,o.data,null,this.componentData.mutationImage,this.componentData.getterImage),await this.$store.dispatch("getCollections")},async deleteBookmark(t){this.$bus.$emit("dialog-open",`Do you want to permanently delete <b>${t.title}</b> Link ?`),this.$bus.$on("dialog-success",e=>{e&&this.deleteBookmarkApi(t),this.$bus.$off("dialog-success")})},async deleteBookmarkApi(t){await this.$axios.delete("/bookmark/"+t.id),this.$bus.$emit("open-toaster",`<b>${t.title}</b> bookmark deleted.`),this.$helper.setState("delete",this.componentData.mutation,this.componentData.getter,t,null,this.componentData.mutationImage,this.componentData.getterImage)},insertIntoEmail(t){this.insertBookmarksIntoEmail(t.path)},insertBookmarksIntoEmail(t){let e=window.Office.context.mailbox.item;e.body.getTypeAsync((function(o){o.status==window.Office.AsyncResultStatus.Failed||(o.value==window.Office.MailboxEnums.BodyType.Html?e.body.setSelectedDataAsync(`<a href="${t}">${t}</a>`,{coercionType:window.Office.CoercionType.Html},(function(t){t.status,window.Office.AsyncResultStatus.Failed})):e.body.setSelectedDataAsync(t,{coercionType:window.Office.CoercionType.Text,asyncContext:{var3:1,var4:2}},(function(t){t.status,window.Office.AsyncResultStatus.Failed})))}))},insertIntoWrodDocument(t,e){const o=`<a href="${t.path}" target="_blank">${"hyperlink"===e?this.wordDocumentSelectedRange:t.path}</a>`;let n=this;window.Office.context.document.setSelectedDataAsync(o,{coercionType:"html"},(function(t){t.status,window.Office.AsyncResultStatus.Failed,n.$store.commit("SET_WORD_SELECTED_RANGE","")}))},insertHyperlink(t){let e=this;window.Office.context.mailbox.item.getSelectedDataAsync(window.Office.CoercionType.Text,{},(function(o){var n;let i=null===(n=o.value)||void 0===n?void 0:n.data;i?window.Office.context.mailbox.item.body.setSelectedDataAsync(`<a href="${t.path}" target="_blank">${i}</a>`,{coercionType:window.Office.CoercionType.Html},(function(t){t.status!=window.Office.AsyncResultStatus.Failed&&e.$bus.$emit("open-toaster","Hyperlink added to email.")})):(e.$bus.$emit("dialog-open","Please select a text first to add hyperlink."),e.$bus.$on("dialog-success",()=>{e.$bus.$off("dialog-success")}))}))},insertIntoTeamsChat(t){this.$microsoftTeams.dialog.url.submit({title:t.title,path:t.path})},async pinBookmarkHandler(t){try{this.pinningBookmarkId=t.id;let e={...t,isPinned:!t.isPinned};await this.$axios.put("/bookmark/"+t.id,e).then(()=>{this.$bus.$emit("open-toaster",`<b>Link ${t.isPinned?"unpinned":"pinned"} </b><small>Link <strong>${t.title}</strong> has been ${t.isPinned?"unpinned":"pinned"} successfully</small>`,"success")}).catch(()=>{this.$bus.$emit("open-toaster",`<b>Error ${t.isPinned?"unpinning":"pinning"} </b><small>Error  ${t.isPinned?"unpinning":"pinning"} <strong>${t.title}</strong> link.</small>`,"error")}),t.isPinned=!t.isPinned;let o=this.componentData.mutation,n=this.componentData.getter;Object.keys(this.$route.meta).includes("allBookmarks")&&(o="SET_BOOKMARKS",n="bookmarks"),this.$helper.setState("edit",o,n,t,null,this.componentData.mutationImage,this.componentData.getterImage)}finally{this.pinningBookmarkId=null}}}}}}]);