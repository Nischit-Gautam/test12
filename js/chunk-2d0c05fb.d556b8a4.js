(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c05fb"],{4207:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t._self._c;return e("button",{directives:[{name:"tmf-tooltip",rawName:"v-tmf-tooltip",value:{content:t.currentTab&&t.isDublicate?"Remove bookmark":"Bookmark this tab"},expression:"{\n    content: !(currentTab && isDublicate)\n      ? 'Bookmark this tab'\n      : 'Remove bookmark'\n  }"}],staticClass:"btn-control md secondary ml-5p",class:t.isDublicate?"bookmarked-tab-icon":"",attrs:{disabled:!t.isCurrentTabLoaded},on:{click:t.bookmarkTab}},[t.isLoading?e("div",{staticClass:"loader"}):e("span",{staticClass:"plus-icon-container",domProps:{innerHTML:t._s(t.$internalIcons[t.isDublicate?"starFilled":"star"])}})])},a=[],o=(s("14d9"),s("2f62")),n={data(){return{currentTab:{},isLoading:!1}},computed:{...Object(o["b"])(["extensionId","extensionIcons","settings"]),isDublicate(){var t;return!(null===(t=this.currentTab)||void 0===t||!t.isDublicate)},isCurrentTabLoaded(){return Object.keys(this.currentTab).length>0}},mounted(){this.$bus.$on("set-current-tab",()=>{this.currentTab.isDublicate=!0})},async created(){this.getCurrentTab()},methods:{async getCurrentTab(){if(!this.extensionId)return;let t=this;window.chrome.tabs.query({active:!0,lastFocusedWindow:!0},async e=>{var s;let i=e[0];if(!i)return;let a=encodeURI(i.url);await t.$store.dispatch("getSettings");let o=await t.$axios.post("/bookmark/fetch/"+(null===(s=t.settings)||void 0===s?void 0:s.defaultChromeCategory),JSON.stringify(a));t.currentTab={...o.data},t.$store.commit("SET_CURRENT_TAB",t.currentTab),window.chrome.storage.sync.get({linkLists:[]},e=>{let s=e.linkLists;-1===s.indexOf(t.currentTab.path)&&t.isDublicate&&(s.push(t.currentTab.path),window.chrome.storage.sync.set({linkLists:s},()=>{}),window.chrome.browserAction.setIcon({path:t.extensionIcons.active}))})})},async bookmarkTab(){this.isLoading=!0,await this.getCurrentTab(),this.isDublicate?await this.deleteBookmark():await this.$bus.$emit("open-bookmark-form",{withCategoryName:!0,path:this.currentTab.path,bookmarkCuurentTab:!0}),this.isLoading=!1},async deleteBookmark(){let t=await this.$axios.get("/bookmark/search?query="+this.currentTab.path),e=t.data[0];this.$bus.$emit("dialog-open",`Do you want to permanently delete <b>${e.title}</b> Link ?`),this.$bus.$on("dialog-success",t=>{t&&this.deleteBookmarkApi(e),this.$bus.$off("dialog-success")})},async deleteBookmarkApi(t){await this.$axios.delete("/bookmark/"+t.id);let e=this;window.chrome.storage.sync.get({linkLists:[]},t=>{let s=t.linkLists;s.pop(s.indexOf(e.currentTab.path)),window.chrome.storage.sync.set({linkLists:s},()=>{}),window.chrome.browserAction.setIcon({path:e.extensionIcons.inactive})}),this.$bus.$emit("open-toaster",`<b>${t.title}</b> bookmark deleted.`),this.currentTab.isDublicate=!1,this.$store.dispatch("getCollections"),+this.$route.params.collectionId===t.categoryID&&this.$helper.setState("delete","SET_COLLECTION_BOOKMARKS","collectionBookmarks",t,null,"SET_COLLECTION_BOOKMARKS_IMAGES","collectionBookmarksImages")}},beforeDestroy(){this.$bus.$off("set-current-tab")}},r=n,c=s("2877"),l=Object(c["a"])(r,i,a,!1,null,null,null);e["default"]=l.exports}}]);