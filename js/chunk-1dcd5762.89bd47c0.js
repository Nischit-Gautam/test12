(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1dcd5762"],{"6e78":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-app tmf-app"},[t.showSidebar?e("TmfSidebar",{class:t.floatingSidebar?"tmf-sidebar__floating-sidebar":"",attrs:{windowInnerWidth:t.windowInnerWidth}}):t._e(),e("div",{staticClass:"tmf-body w-100",style:t.mainStyles},[e("main",{staticClass:"p-0 pt-3 tmf-main-wrapper tmf-app-main-body"},[e("TmfHeader",{staticClass:"mb-2 px-3"}),e("div",{staticClass:"d-flex"},[e("div",{staticClass:"d-flex flex-column flex-grow-1 px-3 scroll-vertical scroll-overlay",staticStyle:{height:"calc(100vh - 1.5rem - 32px)"}},[e("searched-bookmark-list"),e("router-view")],1),e("TmfTag")],1)],1)])],1)},o=[],d=(i("14d9"),i("2f62")),r={components:{TmfSidebar:()=>i.e("chunk-87220122").then(i.bind(null,"2d3e")),TmfHeader:()=>i.e("chunk-802f4ea0").then(i.bind(null,"29db")),TmfTag:()=>i.e("chunk-f7178c02").then(i.bind(null,"caaae")),searchedBookmarkList:()=>i.e("chunk-2d0b3dd1").then(i.bind(null,"29d8"))},data(){return{windowInnerWidth:window.innerWidth,loadSidebar:!0}},computed:{...Object(d["b"])(["sidebarStatus","sidebarWidth","floatingSidebar","hostType","teamsSharedCollections","searchedBookmarks"]),showSidebar(){var t;return!(null===(t=this.$route)||void 0===t||null===(t=t.meta)||void 0===t||!t.showSidebar)&&this.sidebarStatus&&this.loadSidebar},mainStyles(){return this.sidebarStatus&&!this.floatingSidebar?{"margin-left":this.sidebarWidth}:{}},showCollapseSidebar(){return this.windowInnerWidth<600}},async beforeCreate(){let t=this;window.innerWidth<600&&await this.$store.dispatch("getCollections");try{let t=this.$microsoftTeams.app;await t.initialize(),await t.getContext().then(async t=>await e(t))}catch(a){console.error(a)}async function e(e){var a,o,d,r,n;if(null!==e||void 0!==e)if(null!==e&&void 0!==e&&null!==(a=e.team)&&void 0!==a&&a.groupId){t.loadSidebar=!1;try{t.$store.commit("SET_TEAMS_GROUP",e);let i=e.team.groupId,a=await t.$axios.get("/share/currentteam-shared-collection/"+i),o=a.data;t.$store.commit("SET_CURRENT_TEAMS",o);let d=await t.$store.dispatch("getCollectionChildren",a.data);t.$store.commit("SET_CURRENT_TEAMS_CHANNEL",d);let r=null===d||void 0===d?void 0:d.filter(t=>t.teamsChannelID===e.channel.id),n=`${t.$route.matched[0].path}/teams-shared/${e.channel.id}/${r[0].id}`;t.$route.path!==n&&(t.$store.commit("SET_SELECTED_COLLECTION",o),t.$router.push(n))}catch(h){await i()}finally{t.loadSidebar=!0}}else if(void 0===(null===e||void 0===e||null===(o=e.team)||void 0===o?void 0:o.groupId)&&void 0!==(null===(d=e.chat)||void 0===d?void 0:d.id)&&null!==(null===(r=e.chat)||void 0===r?void 0:r.id)&&""!==(null===(n=e.chat)||void 0===n?void 0:n.id)){t.loadSidebar=!1;try{var s,l;t.$store.commit("SET_TEAMS_GROUP",e);let i=null===(s=e.chat)||void 0===s?void 0:s.id,a=null===(l=e.meeting)||void 0===l?void 0:l.id,o=await t.$axios.get(`/share/currentteam-group-shared-collection/${i}/${a}`),d=o.data;t.$store.commit("SET_CURRENT_TEAMS",d);let r=`${t.$route.matched[0].path}/teams-shared/${null!==a&&void 0!==a?a:i}/${d.id}`;t.$route.path!==r&&(t.$store.commit("SET_SELECTED_COLLECTION",d),t.$router.push(r))}catch(h){await i()}finally{t.loadSidebar=!0}}else await i()}async function i(){var e;"OutlookRead"===t.$route.matched[0].name?t.$router.push(t.$route.path.replace(/\/$/,"")+"/email"):null!==(e=Object.keys(t.$route.meta))&&void 0!==e&&e.some(t=>"landingPage"===t)&&t.$router.push(t.$route.path.replace(/\/$/,"")+"/all")}this.$route.params.collectionId&&await this.$store.dispatch("getCollectionById",{collectionId:this.$route.params.collectionId}).then(t=>{this.$store.commit("SET_SELECTED_COLLECTION",t)}),"teams"!==this.hostType&&await i()},created(){window.addEventListener("resize",this.getWindowWidth),this.showCollapseSidebar&&this.$store.commit("SET_SIDEBAR_STATUS")},async mounted(){let t="chrome"===this.hostType?"Chrome Extension":this.hostType;this.$axios.get("/user/appEntry?appPlatform="+t)},methods:{getWindowWidth(t){this.windowInnerWidth!==t.target.innerWidth&&(this.windowInnerWidth=t.target.innerWidth,this.$store.commit("SET_FLOATING_SIDEBAR_STATUS",this.windowInnerWidth<600))}},watch:{windowInnerWidth:{immediate:!0,handler(t){this.$store.commit("SET_SIDEBAR_WIDTH",t)}}},destroyed(){window.removeEventListener("resize",this.getWindowWidth)}},n=r,s=(i("a0cc"),i("2877")),l=Object(s["a"])(n,a,o,!1,null,"dd8f9b32",null);e["default"]=l.exports},a0cc:function(t,e,i){"use strict";i("b428")},b428:function(t,e,i){}}]);