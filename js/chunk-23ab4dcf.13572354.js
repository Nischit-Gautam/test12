(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-23ab4dcf"],{"1d3c":function(e,t,s){},5609:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{key:e.componentKey,staticClass:"d-flex flex-column select-control",class:[e.nomargin?"":"mb-3",e.disabled?"select-is-disabled":""]},[e.label?t("label",{attrs:{for:e.name}},[e._v(e._s(e.label))]):e._e(),t("TmfDropdown",{staticClass:"w-100 multi-select-dropdown",attrs:{disabled:e.disabled,show:e.showMultiselectDropdown,menuPosition:"bottom",dropdownComponentKey:e.dropdownComponentKey,trackerId:e.trackerId},on:{"update:show":function(t){e.showMultiselectDropdown=t}}},[t("template",{slot:"header"},[e.multiple?t("TmfInput",{attrs:{formAttributes:{type:"text",name:"Name",autocomplete:"off",autofill:"off",disabled:e.disabled,maxLength:e.maxLength,placeholder:(e.multiple?"Search a ":"Select a ")+e.name,disableName:!0},formErrors:e.formErrors,value:e.search},on:{"update:value":function(t){e.search=t},keypressEnterPrevent:function(t){return e.addNewTag(t)}}}):t("div",{staticClass:"select-control--selected form-control"},[e.selectCollectionMode?t("span",{staticClass:"d-flex align-items-center justify-content-between"},[e._l(e.currentOptions,(function(s,i){return[s.isOpen?t("dropdown-items",{key:i,attrs:{options:s},on:{moveToSelected:function(t){return e.selectOption(t)}}}):e._e()]})),e.collectionIsLoading?t("TmfSpinner",{staticClass:"small"}):e._e()],2):t("span",[e._v(e._s(e.sigleSelectName?e.sigleSelectName:"Select a "+e.name))])])],1),e.multiple?e._e():t("div",[t("TmfInput",{staticClass:"mx-2 mb-1",attrs:{formAttributes:{type:"text",autocomplete:"off",autofill:"off",placeholder:(e.multiple?"Search a ":"Select a ")+e.name,name:"search",disableName:!0},value:e.search},on:{"update:value":function(t){e.search=t}}})],1),e._l(e.filterdOptions,(function(s,i){return[e.selectedIds.includes(s[e.trackName])?e._e():t("div",{key:i,staticClass:"multiselect-dropdown__item",on:{click:function(t){return e.selectOption(s)}}},[e.selectCollectionMode&&s.hasChildren?t("span",{staticClass:"rotate-icon--90-deg multiselect-dropdown-down-icon",domProps:{innerHTML:e._s(e.$internalIcons.down)}}):e._e(),t("div",{staticClass:"multiselect-dropdown__item__name"},[e._v(" "+e._s(s.name)+" ")])])]})),e.filterdOptions.length?e._e():t("div",{staticClass:"multiselect-dropdown__notfound"},[e.multiselectTag?t("span",{staticClass:"d-flex align-items-center justify-content-between message"},[e._v(" Tag not found! "),t("small",{staticClass:"light"},[e._v("Press enter to create this tag.")])]):t("span",[e._v("no content.")])])],2),e.selected.length?t("div",{staticClass:"selected-options"},[e._l(e.selected,(function(s,i){return[t("span",{directives:[{name:"tmf-tooltip",rawName:"v-tmf-tooltip",value:{content:s[e.trackBy]},expression:"{ content: select[trackBy] }"}],key:i,staticClass:"d-flex align-items-center justify-content-center selected-options--item"},[t("span",[e._v(e._s(s[e.trackBy]))]),t("span",{staticClass:"selected-option-close align-items-center justify-content-center rotate-icon-45-deg",domProps:{innerHTML:e._s(e.$internalIcons.plusBold)},on:{click:function(t){return e.removeOption(i)}}})])]}))],2):e._e()],1)},l=[],n=(s("14d9"),s("13d5"),{props:{trackBy:{type:String,required:!1,default:"name"},trackName:{type:String,required:!1,default:"id"},label:{type:String,required:!1,default:"label"},name:{type:String,required:!1,default:""},options:{type:Array,required:!0},value:{type:[Array,Number],required:!1},multiple:{type:Boolean,required:!1,default:!1},filter:{type:String,required:!1,default:""},nomargin:{type:Boolean,required:!1,default:!1},disabled:{type:Boolean,required:!1,default:!1},selectCollectionMode:{type:Boolean,required:!1,default:!1},multiselectTag:{type:Boolean,required:!1,default:!1},maxLength:{type:Number,required:!1,default:200},selectedOption:{type:Object,required:!1,default:()=>({})},trackerId:{type:String,required:!1,default:""}},components:{DropdownItems:()=>s.e("chunk-7e03961a").then(s.bind(null,"9aeb"))},data(){return{selected:[],search:"",singleSelected:null,sigleSelectName:"",currentOptions:[],currentChilds:[],componentKey:0,collectionIsLoading:!1,showMultiselectDropdown:!1,formErrors:{},dropdownComponentKey:0}},created(){this.selectCollectionMode&&this.value&&this.searchForSelected(this.options,this.value)},computed:{filterdOptions(){return this.currentChilds.length?this.currentChilds.filter(e=>{if(void 0!==e[this.trackBy])return e[this.trackBy].toLowerCase().includes(this.search.toLowerCase())}).filter(e=>!this.filter||!e[this.filter]):[]},selectedIds(){let e=[];return this.selected.forEach(t=>{e.push(t[this.trackName])}),e}},methods:{removeOption(e){this.selected.splice(e,1),this.$emit("input",this.selected)},selectOption(e){var t;let s=!0;if(null!==(t=e)&&void 0!==t&&t.remove){let t=e.path.split(".");if(t.length>2){let s=this.currentOptions[t[0]];t.pop(),t.shift();let i=t.join("."),l=(e,t)=>t.split(".").reduce((e,t)=>e.childrens[t],e);e=l(s,i)}else 2===t.length?e=this.currentOptions[t[0]]:1===t.length&&(this.currentOptions=this.resetOptions(this.currentOptions),this.currentChilds=this.currentOptions,s=!1,this.componentKey++,e={});delete e.remove}let i=e;this.multiple?this.selected=[...this.selected,e]:e?(this.sigleSelectName=e[this.trackBy],this.singleSelected=e[this.trackName]):(this.singleSelected=null,this.singleSelectedName=""),this.$emit("input",this.multiple?this.selected:this.singleSelected),this.$emit("selectedOption",this.multiple?[]:i),s&&this.checkForselectCollectionMode(e)},async checkForselectCollectionMode(e){if(!this.selectCollectionMode)return;this.search="";let t=[];var s;if(null!==e&&void 0!==e&&e.hasChildren)if((null===e||void 0===e||null===(s=e.childrens)||void 0===s?void 0:s.length)>0){let t=e.childrens.map(e=>(e.isOpen=!1,e.isSelected=!1,e));this.currentChilds=[...t]}else try{this.collectionIsLoading=!0,this.$emit("collectionLoading",!0);let s=await this.$axios.get(`/category/${e.id}/subcategories`);t=s.data.map((t,s)=>(t.path=`${e.path}.${s}`,t.isOpen=!1,t.isSelected=!1,t)),this.currentChilds=[...t]}finally{this.collectionIsLoading=!1,this.$emit("collectionLoading",!1)}else this.currentChilds=[];function i(e,s){let l=null,n=s.split("."),r="";return l=parseInt(n.slice(0,1)),n.length>1&&(r=n.slice(1,n.length).join(".")),e.map((e,s)=>(null!==l&&l===s&&(e.isOpen=!0,r?i(e.childrens,r):(e.isSelected=!0,e.childrens=[...e.childrens||[],...t])),e))}this.currentOptions=this.resetOptions(this.currentOptions),this.currentOptions=i(this.currentOptions,e.path),this.componentKey++},resetOptions(e){return e.map(e=>(e.isOpen=!1,e.isSelected=!1,delete e.remove,e.hasChildren&&null!==e&&void 0!==e&&e.childrens&&e.childrens.length&&this.resetOptions(e.childrens),e))},searchForSelected(e,t){e.some((e,s)=>{e.path=""+s,e.id!=t||this.selectOption(e)})},async addNewTag(e){try{let t=e.target.value.trim();if(e.target.value=t,!t)return;if(this.multiselectTag){let s=[];if(this.options.forEach(e=>{s.push(e.name)}),s.includes(t))this.$bus.$emit("open-toaster",`Tag <b>#${t}</b> already added`);else if(1==this.filterdOptions.length&&this.filterdOptions[0].name===t)this.selectOption(this.filterdOptions[0]);else{let e=await this.$axios.post("/tag",{name:t,isPrivate:!0});this.options.push(e.data),this.selectOption(e.data),this.search="",this.$bus.$emit("open-toaster",`Tag <b>#${t}</b> added`)}e.target.blur(),this.showMultiselectDropdown=!1}}catch(t){400===t.status&&(this.formErrors=JSON.parse(t.response)["errors"])}}},watch:{value:{immediate:!0,deep:!0,handler(e){this.multiple?this.selected=e:(this.singleSelected!=e&&this.searchForSelected(this.options,e),this.singleSelected=e,this.currentOptions.forEach(t=>{t[this.trackName]===e&&(this.sigleSelectName=t[this.trackBy])}))}},options:{immediate:!0,deep:!0,handler(e){this.currentOptions=e.map((e,t)=>(e.path=""+t,e)),this.currentChilds=[...this.currentOptions]}},search:{immediate:!0,handler(){this.formErrors={},this.dropdownComponentKey++}},selectedOption:{immediate:!0,deep:!0,handler(e){Object.keys(e).length&&this.selectOption(e)}}}}),r=n,o=(s("a598"),s("2877")),a=Object(o["a"])(r,i,l,!1,null,null,null);t["default"]=a.exports},a598:function(e,t,s){"use strict";s("1d3c")}}]);