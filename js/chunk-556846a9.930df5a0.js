(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-556846a9"],{"00ee":function(t,e,n){"use strict";var i=n("b622"),r=i("toStringTag"),o={};o[r]="z",t.exports="[object z]"===String(o)},"0d26":function(t,e,n){"use strict";var i=n("e330"),r=Error,o=i("".replace),s=function(t){return String(new r(t).stack)}("zxcasd"),a=/\n\s*at [^:]*:[^\n]*/,c=a.test(s);t.exports=function(t,e){if(c&&"string"==typeof t&&!r.prepareStackTrace)while(e--)t=o(t,a,"");return t}},1787:function(t,e,n){"use strict";var i=n("861d");t.exports=function(t){return i(t)||null===t}},"2ba4":function(t,e,n){"use strict";var i=n("40d5"),r=Function.prototype,o=r.apply,s=r.call;t.exports="object"==typeof Reflect&&Reflect.apply||(i?s.bind(o):function(){return s.apply(o,arguments)})},"3bbe":function(t,e,n){"use strict";var i=n("1787"),r=String,o=TypeError;t.exports=function(t){if(i(t))return t;throw new o("Can't set "+r(t)+" as a prototype")}},"54c1":function(t,e,n){"use strict";n("ff31")},"577e":function(t,e,n){"use strict";var i=n("f5df"),r=String;t.exports=function(t){if("Symbol"===i(t))throw new TypeError("Cannot convert a Symbol value to a string");return r(t)}},"5be1":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"email-wrappers pt-0"},[e("div",{staticClass:"mb-3 d-flex flex-column"},[e("div",{staticClass:"d-flex justify-content-between align-items-center mb-1"},[e("div",{staticClass:"d-flex align-items-center"},[t.category?e("h6",{staticClass:"m-0"},[t._v(" "+t._s(t.category)+" ")]):t._e(),!t.isCollectionPresent&&t.category?e("button",{directives:[{name:"tmf-tooltip",rawName:"v-tmf-tooltip",value:{content:"Add Email as Collection"},expression:"{\n              content: 'Add Email as Collection'\n            }"}],staticClass:"btn-control icon sm sq light mx-1",on:{click:function(e){return t.$bus.$emit("open-collection-form",{withNewCategory:t.category})}}},[e("span",{domProps:{innerHTML:t._s(t.$internalIcons.addCollection)}})]):t._e(),e("info",{attrs:{message:"Email Links"}})],1)]),e("div",{staticClass:"d-flex align-items-center justify-content-between"},[t.isEmailLinkPresent?t._e():e("button",{staticClass:"btn-control button-bookmark-email sm light",on:{click:function(e){return t.$bus.$emit("open-bookmark-form",{withCategoryName:t.category,path:t.emailData.path,title:t.emailData.title,createCollection:!t.isCollectionPresent})}}},[t._v(" Bookmark this email ")]),"OutlookReadEmail"===t.$route.name?e("button",{directives:[{name:"tmf-tooltip",rawName:"v-tmf-tooltip",value:{content:"Add Link"},expression:"{\n            content: 'Add Link'\n          }"}],staticClass:"btn-control sm primary",on:{click:function(e){return t.$bus.$emit("open-bookmark-form")}}},[e("span",{staticClass:"plus-icon-container",domProps:{innerHTML:t._s(t.$internalIcons.plusWeighted)}})]):t._e()])]),t.isLoading?e("div",t._l(5,(function(n){return e("div",{key:n,staticClass:"app-card d-flex flex-column mb-1"},[t._m(0,!0),e("div",{staticClass:"skeletion-loader",staticStyle:{width:"100%",height:"6px","border-radius":"2px","margin-bottom":"1px"}}),e("div",{staticClass:"skeletion-loader",staticStyle:{width:"70%",height:"6px","border-radius":"2px"}})])})),0):e("div",[t.urls.length?e("ul",{key:t.componentKey},[t._l(t.urls,(function(n,i){return[e("li",{key:i,staticClass:"app-card d-flex flex-column",class:[void 0!==n.result?"Safe"===n.result?"safe":"not-safe":""],on:{mouseenter:t.enterOverLink,mouseleave:t.leaveLink}},[e("div",{staticClass:"d-flex align-items-center"},[e("div",{staticClass:"image-wrapper mr-2",staticStyle:{overflow:"visible !important"}},[e("span",{staticStyle:{position:"relative"}},[e("img",{attrs:{src:"https://www.google.com/s2/favicons?domain="+n.path}}),void 0!==n.result&&null!==n.result?e("span",{staticStyle:{position:"absolute",top:"-5px !important",right:"-5px","background-color":"white !important","border-radius":"10px !important"},domProps:{innerHTML:t._s("Safe"===n.result?t.$internalIcons.userShieldSuccess:t.$internalIcons.userShieldUnsuccess)}}):t._e()])]),e("div",{staticClass:"flex-grow-1 mr-2 email-link-title"},[t._v(" "+t._s(n.title)+" ")]),e("div",{staticClass:"d-flex align-items-center"},[e("button",{directives:[{name:"tmf-tooltip",rawName:"v-tmf-tooltip",value:{content:"Add Link"},expression:"{\n                    content: 'Add Link'\n                  }"}],staticClass:"btn-control sm icon light sq",on:{click:function(e){return t.$bus.$emit("open-bookmark-form",{withCategoryName:t.category,path:n.path,title:n.title})}}},[e("span",{domProps:{innerHTML:t._s(t.$internalIcons.plusBold)}})]),!1===t.safeLink?e("button",{directives:[{name:"tmf-tooltip",rawName:"v-tmf-tooltip",value:{content:"View QR Code"},expression:"{\n                    content: 'View QR Code'\n                  }"}],staticClass:"btn-control sm icon light sq",on:{click:function(e){return t.$bus.$emit("open-qr-modal",n.path)}}},[e("span",{domProps:{innerHTML:t._s(t.$internalIcons.qrCode)}})]):t._e(),!0===t.safeLink?e("button",{directives:[{name:"tmf-tooltip",rawName:"v-tmf-tooltip",value:{content:"Open Related Links"},expression:"{\n                    content: 'Open Related Links'\n                  }"}],staticClass:"btn-control sm icon light sq",on:{click:function(e){return t.$bus.$emit("open-show-links-modal",n)}}},[!0===n.isSafeLinkLoading?e("div",{staticClass:"loader"}):e("span",{domProps:{innerHTML:t._s(t.$internalIcons.openLink)}})]):t._e(),e("button",{directives:[{name:"tmf-tooltip",rawName:"v-tmf-tooltip",value:{content:"Copy Link"},expression:"{\n                    content: 'Copy Link'\n                  }"}],staticClass:"btn-control sm icon light sq",on:{click:function(e){return t.copyLink(n)}}},[e("span",{domProps:{innerHTML:t._s(t.$internalIcons.copy)}})])])]),e("a",{staticClass:"email-link",attrs:{href:n.path,target:"_blank"}},[t._v(" "+t._s(n.path)+" ")])])]}))],2):e("div",[t._v("No content.")])])])])},r=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"d-flex align-items-center mb-1"},[e("div",{staticClass:"skeletion-loader mr-1",staticStyle:{width:"12px",height:"12px","border-radius":"2px"}}),e("div",{staticClass:"skeletion-loader flex-grow-1 mr-5",staticStyle:{width:"auto",height:"10px","border-radius":"2px"}}),e("div",{staticClass:"skeletion-loader ml-5",staticStyle:{width:"14px",height:"14px","border-radius":"3px"}})])}],o=(n("d9e2"),n("14d9"),n("13d5"),n("2f62")),s={data(){return{urls:[],category:"",checkedUrls:[],isLoading:!1,emailData:{},isEmailLinkPresent:!0,componentKey:0,safeLink:!1}},computed:{...Object(o["b"])(["collections"]),isCollectionPresent(){return!!(this.collections&&this.collections.length&&this.category)&&this.collections.some(t=>t.name===this.category)}},created(){this.initialize(),this.getSafeLink()},mounted(){this.$bus.$on("reset-outlook-emails",()=>{this.initialize(),this.getSafeLink()})},methods:{async getSafeLink(){await this.$axios.get("Setting/GetSafeLinksSettings").then(t=>this.safeLink=t.data.safeLink).catch(()=>this.$bus.$emit("open-toaster","Error getting safe link settings","error"))},async checkSafeLinks(t){this.urls[t].isSafeLinkLoading=!0,this.componentKey++;try{var e=await this.$axios.post("Bookmark/CheckSafeLinks",this.urls[t]);200===e.status&&(this.urls[t]=e.data)}finally{this.urls[t].isSafeLinkLoading=!1,this.componentKey++}},initialize(){this.getAllUrlsinEmail(),window.Office.context.mailbox.addHandlerAsync(window.Office.EventType.ItemChanged,this.getAllUrlsinEmail,(function(t){t.status,window.Office.AsyncResultStatus.Failed}))},copyLink(t){const e=document.createElement("textarea");e.value=t.path,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),this.$bus.$emit("open-toaster","Link copied")},getAllUrlsinEmail(){this.isLoading=!0,this.urls=[];let t=[];this.getCategory();let e=window.Office.context.mailbox.item;e.body.getAsync("html",async e=>{let n=await(new DOMParser).parseFromString(e.value,"text/html"),i=n.getElementsByTagName("a");for(let o=0;o<i.length;o++){var r;if(null!==(r=i[o].attributes)&&void 0!==r&&null!==(r=r.href)&&void 0!==r&&null!==(r=r.value)&&void 0!==r&&r.length){let e=i[o].href;e.length>0&&(e.startsWith("mailto:")&&(e=e.replace("mailto:","")),t.push({path:e,title:i[o].innerText.trim()}))}}this.urls=[...null===t||void 0===t?void 0:t.reduce((t,e)=>t.set(e.path,e),new Map).values()],this.emailData=await this.getEmailUrl(),this.isLoading=!1})},async getEmailUrl(){let t=await this.getCallbackToken(),e=window.Office.context.mailbox.item.subject+" "+this.$helper.dateFormatter(window.Office.context.mailbox.item.dateTimeCreated),n={path:t.WebLink,title:e};return await this.checkForPath(n.path),n},getCallbackToken(){return new Promise((t,e)=>{window.Office.context.mailbox.getCallbackTokenAsync({isRest:!0},(function(n){if("succeeded"===n.status){const e=window.Office.context.mailbox.item.itemId,i=n.value,r=window.Office.context.mailbox.convertToRestId(e,window.Office.MailboxEnums.RestVersion.v2_0),o=window.Office.context.mailbox.restUrl+"/v2.0/me/messages/"+r,s=new XMLHttpRequest;s.open("GET",o),s.setRequestHeader("Authorization","Bearer "+i),s.onload=function(){const e=JSON.parse(this.responseText);t(e)},s.send()}else e(new Error("Failed to get callback token"))}))})},async checkForPath(t){try{await this.$store.dispatch("checkBookmarkUrl",t),this.isEmailLinkPresent=!1}catch(e){409===e.status&&(this.isEmailLinkPresent=!0)}},getCategory(){this.category=window.Office.context.mailbox.item.from.displayName},async checkForbookmark(){let t=[];this.urls.forEach(e=>{t.push(e.path)});let e=await this.$axios.post("bookmark/Bookmark-Array",t);this.checkedUrls=this.urls.filter(t=>e.data.includes(t.path))},enterOverLink(t){t.currentTarget.classList.add("link-hover")},leaveLink(t){t.currentTarget.classList.remove("link-hover")}},beforeDestroy(){this.$bus.$off("reset-outlook-emails")}},a=s,c=(n("54c1"),n("2877")),l=Object(c["a"])(a,i,r,!1,null,null,null);e["default"]=l.exports},"6f19":function(t,e,n){"use strict";var i=n("9112"),r=n("0d26"),o=n("b980"),s=Error.captureStackTrace;t.exports=function(t,e,n,a){o&&(s?s(t,e):i(t,"stack",r(n,a)))}},7156:function(t,e,n){"use strict";var i=n("1626"),r=n("861d"),o=n("d2bb");t.exports=function(t,e,n){var s,a;return o&&i(s=e.constructor)&&s!==n&&r(a=s.prototype)&&a!==n.prototype&&o(t,a),t}},7282:function(t,e,n){"use strict";var i=n("e330"),r=n("59ed");t.exports=function(t,e,n){try{return i(r(Object.getOwnPropertyDescriptor(t,e)[n]))}catch(o){}}},ab36:function(t,e,n){"use strict";var i=n("861d"),r=n("9112");t.exports=function(t,e){i(e)&&"cause"in e&&r(t,"cause",e.cause)}},aeb0:function(t,e,n){"use strict";var i=n("9bf2").f;t.exports=function(t,e,n){n in t||i(t,n,{configurable:!0,get:function(){return e[n]},set:function(t){e[n]=t}})}},b980:function(t,e,n){"use strict";var i=n("d039"),r=n("5c6c");t.exports=!i((function(){var t=new Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",r(1,7)),7!==t.stack)}))},d2bb:function(t,e,n){"use strict";var i=n("7282"),r=n("825a"),o=n("3bbe");t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{t=i(Object.prototype,"__proto__","set"),t(n,[]),e=n instanceof Array}catch(s){}return function(n,i){return r(n),o(i),e?t(n,i):n.__proto__=i,n}}():void 0)},d9e2:function(t,e,n){"use strict";var i=n("23e7"),r=n("da84"),o=n("2ba4"),s=n("e5cb"),a="WebAssembly",c=r[a],l=7!==new Error("e",{cause:7}).cause,u=function(t,e){var n={};n[t]=s(t,e,l),i({global:!0,constructor:!0,arity:1,forced:l},n)},f=function(t,e){if(c&&c[t]){var n={};n[t]=s(a+"."+t,e,l),i({target:a,stat:!0,constructor:!0,arity:1,forced:l},n)}};u("Error",(function(t){return function(e){return o(t,this,arguments)}})),u("EvalError",(function(t){return function(e){return o(t,this,arguments)}})),u("RangeError",(function(t){return function(e){return o(t,this,arguments)}})),u("ReferenceError",(function(t){return function(e){return o(t,this,arguments)}})),u("SyntaxError",(function(t){return function(e){return o(t,this,arguments)}})),u("TypeError",(function(t){return function(e){return o(t,this,arguments)}})),u("URIError",(function(t){return function(e){return o(t,this,arguments)}})),f("CompileError",(function(t){return function(e){return o(t,this,arguments)}})),f("LinkError",(function(t){return function(e){return o(t,this,arguments)}})),f("RuntimeError",(function(t){return function(e){return o(t,this,arguments)}}))},e391:function(t,e,n){"use strict";var i=n("577e");t.exports=function(t,e){return void 0===t?arguments.length<2?"":e:i(t)}},e5cb:function(t,e,n){"use strict";var i=n("d066"),r=n("1a2d"),o=n("9112"),s=n("3a9b"),a=n("d2bb"),c=n("e893"),l=n("aeb0"),u=n("7156"),f=n("e391"),d=n("ab36"),p=n("6f19"),m=n("83ab"),h=n("c430");t.exports=function(t,e,n,b){var v="stackTraceLimit",k=b?2:1,g=t.split("."),y=g[g.length-1],w=i.apply(null,g);if(w){var x=w.prototype;if(!h&&r(x,"cause")&&delete x.cause,!n)return w;var C=i("Error"),L=e((function(t,e){var n=f(b?e:t,void 0),i=b?new w(t):new w;return void 0!==n&&o(i,"message",n),p(i,L,i.stack,2),this&&s(x,this)&&u(i,this,L),arguments.length>k&&d(i,arguments[k]),i}));if(L.prototype=x,"Error"!==y?a?a(L,C):c(L,C,{name:!0}):m&&v in w&&(l(L,w,v),l(L,w,"prepareStackTrace")),c(L,w),!h)try{x.name!==y&&o(x,"name",y),x.constructor=L}catch(_){}return L}}},f5df:function(t,e,n){"use strict";var i=n("00ee"),r=n("1626"),o=n("c6b6"),s=n("b622"),a=s("toStringTag"),c=Object,l="Arguments"===o(function(){return arguments}()),u=function(t,e){try{return t[e]}catch(n){}};t.exports=i?o:function(t){var e,n,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=u(e=c(t),a))?n:l?o(e):"Object"===(i=o(e))&&r(e.callee)?"Arguments":i}},ff31:function(t,e,n){}}]);