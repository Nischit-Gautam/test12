(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7b759355"],{"32ae":function(e,o,t){e.exports=t.p+"img/80X80.6118d3b1.png"},"3a2d":function(e,o,t){e.exports=t.p+"img/empty.c71bcae9.svg"},"8ff1":function(e,o,t){"use strict";t("e625")},d8a7:function(e,o,t){"use strict";t.r(o);var a=function(){var e=this,o=e._self._c;return o("div",{key:e.componentKey,staticClass:"bookmarks",class:"grid"===e.bookmarkViewType?"grid-view":""},[o("bookmark-header",{ref:"selectAllBookmark",attrs:{componentData:{...e.componentData.header},searchBookmarkMode:e.searchBookmarkMode,count:e.bookmarkCount,allBookmarkCount:e.allBookmarkCount,withNoSelectCollection:e.componentData.withNoSelectCollection},on:{selectBookmarksHandler:function(o){e.selectAllBookmark=o},changeEmailHandler:function(o){e.toggleOutlookEmails=o}}}),e.toggleOutlookEmails&&!e.searchBookmarkMode?o("OutlookReadEmails",{staticClass:"view-email-container mt-1"}):e._e(),"word"!==e.hostType||e.searchBookmarkMode?e._e():o("TmdCollectionDocumentLinks"),!("hideMultiselect"in e.componentData)&&e.selectedBookmarkCount?o("multiselect-bookmarks",{attrs:{parentcomponentData:e.componentData,componentData:e.componentData.multiple,selectedBookmarks:e.selectedBookmarks},on:{resetSelectedBookmarks:function(o){e.selectedBookmarks=[]}}}):e._e(),e.isLoading?o("bookmark-loader",{staticClass:"mt-2"}):[e.bookmarkCount?o("ul",{staticClass:"bookmarks-wrapper mt-2"},[e._l(e.bookmarks,(function(t,a){return[o("li",{key:a,staticClass:"bookmark--item app-card",class:e.selectedBookmarks.includes(t.id)?"bookark--item-selected":"",attrs:{draggable:!("disableDraggable"in e.bookmarkComponentDataHandler(t)),"data-id":t.id},on:{contextmenu:function(o){o.preventDefault(),e.openContextMenu(o,{bookmark:t,bookmarksImagesOnly:e.bookmarksImagesOnly.find(e=>e.id==t.id),index:a,actions:e.bookmarkComponentDataHandler(t).actions})},dragstart:function(o){e.$helper.dragStart(o,t,e.selectedBookmarks,"disableDraggable"in e.bookmarkComponentDataHandler(t),e.$store.getters.selectedCollection)},dragend:e.$helper.dragEnd,dblclick:function(o){return e.previewBookmark(o,t)},click:function(o){return e.onBookmarkClick(t)}}},[o("span",{staticClass:"bookmark--close-icon",domProps:{innerHTML:e._s(e.$internalIcons.plusBold)},on:{contextmenu:function(e){e.preventDefault()},click:e.removePreviewBookmark}}),"hideMultiselect"in e.bookmarkComponentDataHandler(t)?e._e():o("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedBookmarks,expression:"selectedBookmarks"}],staticClass:"bookmark--item--checkbox",attrs:{type:"checkbox"},domProps:{value:t.id,checked:Array.isArray(e.selectedBookmarks)?e._i(e.selectedBookmarks,t.id)>-1:e.selectedBookmarks},on:{click:e.checkboxIsChanged,change:function(o){var a=e.selectedBookmarks,i=o.target,s=!!i.checked;if(Array.isArray(a)){var r=t.id,n=e._i(a,r);i.checked?n<0&&(e.selectedBookmarks=a.concat([r])):n>-1&&(e.selectedBookmarks=a.slice(0,n).concat(a.slice(n+1)))}else e.selectedBookmarks=s}}}),o("div",{staticClass:"bookmark--item-wrapper"},[o("div",{directives:[{name:"lazyload",rawName:"v-lazyload"}],staticClass:"bookmark--item-image image-wrapper",attrs:{id:t.id}},[o("image-loader")],1),o("div",{staticClass:"bookmark--item-main"},[o("div",{staticClass:"bookmark--item-main-wrapper"},[o("a",{staticClass:"bookmark--item-path text-color-lighter d-block",attrs:{draggable:"false",href:4==t.type?"mailto:"+t.path:t.path,target:"_blank"},on:{click:function(o){return e.handleLinkClick(t)}}},[o("h5",{staticClass:"m-0 text-color-dark"},[e._v(e._s(t.title))]),o("div",{staticClass:"app-card"},[e._v(" "+e._s(t.path)+" ")])]),t.description?o("p",{staticClass:"my-1 bookmark--item-description"},[e._v(" "+e._s(t.description)+" ")]):e._e(),t&&null!==t.tags&&e.bookmartTagsCount(t)?o("div",{staticClass:"d-flex align-items-center link-tags flex-wrap"},[e._l(t.tags,(function(t,a){return[o("span",{key:a,staticClass:"mr-2 tag-item"},[o("span",{staticStyle:{cursor:"pointer"},on:{click:function(o){return e.$bus.$emit("search-using-tags",t.name)}}},[e._v("#"+e._s(t.name))]),o("div",{staticClass:"tag-description-box"},[o("div",{staticClass:"app-card"},[o("strong",[e._v("#"+e._s(t.name))]),o("span",{staticClass:"tag-type"},[e._v(e._s(t.isShared?"Shared":"Private"))]),o("p",{staticClass:"tag-description mb-0"},[e._v(" "+e._s(t.description)+" ")])])])])]}))],2):e._e()])]),o("div",{staticClass:"d-flex flex-column align-items-end justify-content-between ml-2 bookmark--actions-wrapper"},[o("bookmark-dropdown",e._b({},"bookmark-dropdown",{bookmark:{...t,isSearch:e.searchBookmarkMode,withNoSelectCollection:e.componentData.withNoSelectCollection},bookmarksImagesOnly:e.bookmarksImagesOnly.filter(e=>e.id===t.id),componentData:e.bookmarkComponentDataHandler(t).actions,index:a},!1))],1)]),o("bookmark-tag-form",{key:e.tagComponentKey,ref:"link-tag-"+t.id,refInFor:!0,on:{stopComponentLoader:function(o){e.stopComponentLoader=o}}})],1)]})),o("bookmark-context-menu",{ref:"bookmarkMenuActivator"})],2):o("div",{staticClass:"my-5 link-no-content d-flex flex-column align-items-center justify-content-center"},[o("span",{staticClass:"mb-3"},[o("img",{attrs:{src:e.nocontent,alt:"no content"}})]),o("h6",{staticStyle:{color:"#777474"}},[e._v("No content.")])])]],2)},i=[],s=(t("14d9"),t("32ae")),r=t.n(s),n=t("2f62");let l=t("3a2d");var d={props:{componentData:{type:Object,required:!1,default:()=>({})},bookmarks:{type:Array,required:!1,default:()=>[]},isLoading:{type:Boolean,required:!1,default:!1},searchBookmarkMode:{type:Boolean,required:!1,default:!1},onscrollLoader:{type:Boolean,required:!1,default:!1},allBookmarkCount:{type:Number,required:!1},bookmarksImagesOnly:{type:Array,required:!1,default:()=>[]},iconLoading:{type:Boolean,required:!1,default:!0}},directives:{lazyload:{inserted(e,o,t){const a=t.context.loadImages;a(e)},update(e,o,t){const a=t.context.loadImages;a(e)}}},created(){"teams"===this.hostType&&this.$microsoftTeams.app.initialize()},components:{ImageLoader:()=>t.e("chunk-2d0bd403").then(t.bind(null,"2aca")),BookmarkTagForm:()=>t.e("chunk-5025a75b").then(t.bind(null,"6ba4")),MultiselectBookmarks:()=>t.e("chunk-7d0e2312").then(t.bind(null,"81fd")),BookmarkContextMenu:()=>t.e("chunk-fc97d384").then(t.bind(null,"3a88")),BookmarkDropdown:()=>t.e("chunk-ac947e00").then(t.bind(null,"ba82")),BookmarkHeader:()=>t.e("chunk-0f491e41").then(t.bind(null,"369b")),BookmarkLoader:()=>t.e("chunk-2d228d20").then(t.bind(null,"db8d")),OutlookReadEmails:()=>t.e("chunk-556846a9").then(t.bind(null,"5be1")),TmdCollectionDocumentLinks:()=>t.e("chunk-2d207386").then(t.bind(null,"a034"))},data(){return{tmfLogo:r.a,selectedBookmarks:[],selectAllBookmark:!1,tagComponentKey:0,componentKey:0,toggleOutlookEmails:!1,bookmarkTypeIcons:{private:"userShield",Organization:"organization",TeamsShared:"teamsIcon",UserShared:"shareWithUser",GroupShared:"groupCommunication"},stopComponentLoader:!1,nocontent:l}},computed:{...Object(n["b"])(["user","selectedCollection","isUserAdmin","hostType","bookmarkViewType"]),bookmarkCount(){var e;return(null===(e=this.bookmarks)||void 0===e?void 0:e.length)||0},selectedBookmarkCount(){var e;return(null===(e=this.selectedBookmarks)||void 0===e?void 0:e.length)||0},filteredBookmarks(){return this.bookmarksImagesOnly.filter(e=>this.bookmarks.some(o=>o.userId===e.userId))},isIconLoading(){return this.$store.getters.isIconLoading}},mounted(){this.$bus.$on("reset-selected-bookmarks",()=>{this.selectedBookmarks=[]}),document.addEventListener("keyup",this.handleGlobalEnter)},methods:{async getAllBookmarksImages(){this.allListLoading=!0,this.onscrollLoader=!0;let e=await this.$store.dispatch("getBookmarks",this.page);e.length<this.paginationSize?(this.linkPageLimit=!0,this.allListLoading=!1):(this.page++,this.onscrollLoader=!1)},isTeamsSharedAndNotModifiable(e){var o;return null===e||void 0===e||null===(o=e.categories)||void 0===o?void 0:o.some(e=>{var o;return null===e||void 0===e||null===(o=e.sharedTeams)||void 0===o?void 0:o.some(e=>null!==(null===e||void 0===e?void 0:e.shareWithID)&&!(null!==e&&void 0!==e&&e.allowUsersToModify))})},isUserSharedAndNotModifiable(e){var o;return null===e||void 0===e||null===(o=e.categories)||void 0===o?void 0:o.some(e=>{var o;return null===e||void 0===e||null===(o=e.sharedTeams)||void 0===o?void 0:o.some(e=>null===(null===e||void 0===e?void 0:e.shareWithID)&&!(null!==e&&void 0!==e&&e.allowUsersToModify))})},isPublic(e){var o;return null===e||void 0===e||null===(o=e.categories)||void 0===o?void 0:o.some(e=>null===e||void 0===e?void 0:e.isPublic)},bookmarkComponentDataHandler(e){let o=this.componentData;if(null!==e&&void 0!==e&&e.categories){var t,a,i,s,r;let n=(null===e||void 0===e?void 0:e.userID)===(null===(t=this.user)||void 0===t?void 0:t.id),l=!n&&(null===e||void 0===e||null===(a=e.categories)||void 0===a?void 0:a.some(e=>{var o;return null===e||void 0===e||null===(o=e.sharedTeams)||void 0===o?void 0:o.some(e=>null!==(null===e||void 0===e?void 0:e.shareWithID)&&(null===e||void 0===e?void 0:e.allowUsersToModify))})),d=!n&&(null===e||void 0===e||null===(i=e.categories)||void 0===i?void 0:i.some(e=>{var o;return null===e||void 0===e||null===(o=e.sharedTeams)||void 0===o?void 0:o.some(e=>null===(null===e||void 0===e?void 0:e.shareWithID)&&(null===e||void 0===e?void 0:e.allowUsersToModify))})),c=!(null===(s=this.user)||void 0===s||!s.isAdmin);n||l||d?o=this.$bookmarkTypes.allBookmarks:(this.isPublic(e)&&!c||this.isTeamsSharedAndNotModifiable(e)||this.isUserSharedAndNotModifiable(e))&&(o=this.$bookmarkTypes.publicBookmarks),null!==e&&void 0!==e&&null!==(r=e.categories)&&void 0!==r&&r.some(e=>this.$collectionHelper.isCollectionSharedToGroup(e))&&(o=this.$bookmarkTypes.allBookmarks),e.categories.forEach(e=>{!0===e.isCourt&&(o=this.$bookmarkTypes.courtLinkBookmarks)})}return o},getBookmarkCollectionType(e){if(!e)return;let o="private";return o=this.$collectionHelper.isCollectionSharedInTeams(e)?"TeamsShared":this.$collectionHelper.isCollectionSharedToUser(e)?"UserShared":null!==e&&void 0!==e&&e.isPublic?"Organization":this.$collectionHelper.isCollectionSharedToGroup(e)?"GroupShared":"private",o},svgIdentifierHandler(e){var o;return null===e||void 0===e||null===(o=e.trim())||void 0===o?void 0:o.startsWith("<svg")},bookmartTagsCount(e){var o;return(null===e||void 0===e||null===(o=e.tags)||void 0===o?void 0:o.length)||0},openContextMenu(e,o){void 0!==o.bookmarksImagesOnly&&(o.bookmark.icon=o.bookmarksImagesOnly.icon),o.bookmark.isSearch=this.searchBookmarkMode,o.componentData=this.componentData,this.$refs.bookmarkMenuActivator.open(e,o)},previewBookmark(e,o){this.selectedBookmarks.includes(o.id)||(this.removePreviewBookmark(),e.currentTarget.classList.add("preview-bookmark"))},removePreviewBookmark(){let e=document.querySelectorAll(".bookmark--item");[].forEach.call(e,(function(e){e.classList.remove("preview-bookmark")}))},onBookmarkClick(e){var o;if("hideMultiselect"in this.bookmarkComponentDataHandler(e))return;let t=e.id;if(null!==(o=this.selectedBookmarks)&&void 0!==o&&o.length)if(this.selectedBookmarks.includes(t)){let e=this.selectedBookmarks.indexOf(t);this.selectedBookmarks.splice(e,1)}else this.selectedBookmarks.push(t);let a=event.currentTarget,i=[...a.classList],s=[...event.target.classList];i.includes("preview-bookmark")&&s.includes("bookmark--item")&&a.classList.remove("preview-bookmark")},checkboxIsChanged(e){e.stopPropagation()},loadImages(e){let o=e.getAttribute("id"),t=this.bookmarksImagesOnly.find(e=>e.id==o);if(void 0!=t){let o=t.icon;null===o?e.innerHTML=`<img src="${this.tmfLogo}" alt="" />`:this.svgIdentifierHandler(o)?e.innerHTML=`<div>${o}</div>`:o.includes("base")&&!o.includes("/img")?e.innerHTML=`<img src="${o}" alt="" />`:o.includes("/img")?e.innerHTML=`<img src="${this.tmfLogo}" alt="" />`:e.innerHTML=`<img src="data:image;base64,${o}" alt="" />`}},handleGlobalEnter(e){this.bookmarks.forEach(o=>{const t="link-tag-"+o.id,a=this.$refs[t];a[0]&&a[0].$el.contains(document.activeElement)&&"Enter"===e.key&&""===a[0].$el.querySelector(".tmf-form-element__input-element").value&&a[0].$el.querySelector(".btn-control.md.primary").click()})},async handleLinkClick(e){await this.$axios.post("bookmark/bookmarksClickCount",e)}},beforeDestroy(){document.removeEventListener("keyup",this.handleGlobalEnter)},watch:{selectAllBookmark:{immediate:!0,handler(e){this.selectedBookmarks=[],e&&(this.bookmarks.forEach(e=>{var o;(this.isPublic(e)&&!this.isUserAdmin||this.isTeamsSharedAndNotModifiable(e)||this.isUserSharedAndNotModifiable(e))&&(null===e||void 0===e?void 0:e.userID)!==(null===(o=this.user)||void 0===o?void 0:o.id)||this.selectedBookmarks.push(e.id)}),this.$store.commit("SELECTED_BOOKMARKS",{bookmarks:this.selectedBookmarks,copy:!1,searchMode:this.searchBookmarkMode}))}},selectedBookmarks:{immediate:!0,deep:!0,handler(e){!("hideMultiselect"in this.componentData)&&this.$refs.selectAllBookmark&&this.$nextTick(()=>{if(null!==e&&void 0!==e&&e.length){var o;let t=(null===e||void 0===e?void 0:e.length)===(null===(o=this.bookmarks)||void 0===o?void 0:o.length)&&this.bookmarks.every(o=>e.includes(o.id));t?this.$refs.selectAllBookmark.changeSelectAllInputValue({indeterminate:!1,checked:!0}):this.$refs.selectAllBookmark.changeSelectAllInputValue({indeterminate:!0}),this.$store.commit("SELECTED_BOOKMARKS",{bookmarks:e,copy:!1,searchMode:this.searchBookmarkMode})}else this.$refs.selectAllBookmark.changeSelectAllInputValue({indeterminate:!1,checked:!1})})}},bookmarks:{immediate:!0,deep:!0,handler(){this.selectedBookmarks=[],this.selectAllBookmark=!1,this.stopComponentLoader?this.stopComponentLoader=!1:this.onscrollLoader||(this.loadingImages=!0,this.componentKey++)}}}},c=d,k=(t("8ff1"),t("2877")),m=Object(k["a"])(c,a,i,!1,null,null,null);o["default"]=m.exports},e625:function(e,o,t){}}]);