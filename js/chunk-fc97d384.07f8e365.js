(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-fc97d384"],{"3a88":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t._self._c;return e("vue-context",{ref:"bookmarkMenu",staticClass:"tmf-context-menu",scopedSlots:t._u([{key:"default",fn:function(n){return n.data?[!("hidePin"in t.actions)&&t.$permissionHelper.checkPermission({permissionName:"bookmarkPin",collection:t.selectedCollection})?e("li",{staticClass:"tmf-context-menu__item"},[e("a",{staticClass:"tmf-context-menu__item__link",attrs:{href:"#"},on:{click:function(e){return t.pinBookmarkHandler(n.data.bookmark)}}},[e("span",{staticClass:"tmf-context-menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.pin)}}),e("span",{staticClass:"tmf-context-menu__item__text"},[t._v(" "+t._s(n.data.bookmark.isPinned?"Unpin":"Pin")+" "+t._s(4==n.data.bookmark.type?"Email":"Link")+" ")])])]):t._e(),t.isTrashed?t._e():e("li",{staticClass:"tmf-context-menu__item"},[e("a",{staticClass:"tmf-context-menu__item__link",attrs:{href:"#"},on:{click:function(e){return t.copyLinkHandler(n.data.bookmark)}}},[e("span",{staticClass:"tmf-context-menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.copy)}}),e("span",{staticClass:"tmf-context-menu__item__text"},[t._v("Copy")])])]),[1,0].includes(n.data.bookmark.type)?e("li",{staticClass:"tmf-context-menu__item"},[e("a",{staticClass:"tmf-context-menu__item__link",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.openLinkInNewTab(n.data.bookmark)}}},[e("span",{staticClass:"tmf-context-menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.browser)}}),e("span",{staticClass:"tmf-context-menu__item__text"},[t._v("Open in Browser")])])]):t._e(),"chrome"===t.$store.getters.hostType&&[1,0].includes(n.data.bookmark.type)?e("li",{staticClass:"tmf-context-menu__item"},[e("a",{staticClass:"tmf-context-menu__item__link",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.openLinkInNewTab(n.data.bookmark,"private")}}},[e("span",{staticClass:"tmf-context-menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.privateBrowser)}}),e("span",{staticClass:"tmf-context-menu__item__text"},[t._v(" Open in Private Browser ")])])]):t._e(),4==n.data.bookmark.type?e("li",{staticClass:"tmf-context-menu__item"},[e("a",{staticClass:"tmf-context-menu__item__link",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.openEmailInNewTab(n.data.bookmark)}}},[e("span",{staticClass:"tmf-context-menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.email)}}),e("span",{staticClass:"tmf-context-menu__item__text"},[t._v("Open in Email")])])]):t._e(),e("li",{staticClass:"tmf-context-menu__item"},[e("a",{staticClass:"tmf-context-menu__item__link",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.copyBookmarkLink(n.data.bookmark)}}},[e("span",{staticClass:"tmf-context-menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.copy)}}),e("span",{staticClass:"tmf-context-menu__item__text"},[t._v(" Copy "+t._s(4==n.data.bookmark.type?"Email":"Link")+" ")])])]),e("li",{staticClass:"tmf-context-menu__item"},[e("a",{staticClass:"tmf-context-menu__item__link",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.viewBookmarkQRCode(n.data.bookmark)}}},[e("span",{staticClass:"tmf-context-menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.qrCode)}}),e("span",{staticClass:"tmf-context-menu__item__text"},[t._v("View QR Code")])])]),!("hideEdit"in t.actions)&&t.$permissionHelper.checkPermission({permissionName:"bookmarkEdit",collection:t.selectedCollection})?e("li",{staticClass:"tmf-context-menu__item"},[e("a",{staticClass:"tmf-context-menu__item__link",attrs:{href:"#"},on:{click:function(e){return t.editBookmark({...n.data.bookmark,withNoSelectCollection:t.currentComponentData.withNoSelectCollection})}}},[e("span",{staticClass:"tmf-context-menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.pencil)}}),e("span",{staticClass:"tmf-context-menu__item__text"},[t._v("Edit")])])]):t._e(),!("hideEdit"in t.actions)&&t.$permissionHelper.checkPermission({permissionName:"bookmarkTag",collection:t.selectedCollection})?e("li",{staticClass:"tmf-context-menu__item"},[e("a",{staticClass:"tmf-context-menu__item__link",attrs:{href:"#"},on:{click:function(e){return t.checkForLinkTag(n.data.bookmark,n.data.index)}}},[e("span",{staticClass:"tmf-context-menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.tags)}}),e("span",{staticClass:"tmf-context-menu__item__text"},[t._v("Add Tag")])])]):t._e(),!("hideTrash"in t.actions)&&t.$permissionHelper.checkPermission({permissionName:"bookmarkRemove",collection:t.selectedCollection})?e("li",{staticClass:"tmf-context-menu__item"},[e("a",{staticClass:"tmf-context-menu__item__link",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.trashBookmark(n.data.bookmark)}}},[e("span",{staticClass:"tmf-context-menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.trash)}}),e("span",{staticClass:"tmf-context-menu__item__text"},[t._v("Remove / Trash")])])]):t._e(),"showDelete"in t.actions?e("li",{staticClass:"tmf-context-menu__item"},[e("a",{staticClass:"tmf-context-menu__item__link",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.untrashBookmark(n.data.bookmark)}}},[e("span",{staticClass:"tmf-context-menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.untrash)}}),e("span",{staticClass:"tmf-context-menu__item__text"},[t._v("Untrash Link")])])]):t._e(),"showDelete"in t.actions?e("li",{staticClass:"tmf-context-menu__item"},[e("a",{staticClass:"tmf-context-menu__item__link",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.deleteBookmark(n.data.bookmark)}}},[e("span",{staticClass:"tmf-context-menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.trash)}}),e("span",{staticClass:"tmf-context-menu__item__text"},[t._v("Remove / Delete")])])]):t._e(),"outlook"===t.$store.getters.hostType&&"OutlookCompose"===t.$route.matched[0].name?e("li",{staticClass:"tmf-context-menu__item"},[e("a",{staticClass:"tmf-context-menu__item__link",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.insertIntoEmail(n.data.bookmark)}}},[e("span",{staticClass:"tmf-context-menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.emailLink)}}),e("span",{staticClass:"tmf-context-menu__item__text"},[t._v("Insert into email")])])]):t._e(),"outlook"===t.$store.getters.hostType&&"OutlookCompose"===t.$route.matched[0].name?e("li",{staticClass:"tmf-context-menu__item"},[e("a",{staticClass:"tmf-context-menu__item__link",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.insertHyperlink(n.data.bookmark)}}},[e("span",{staticClass:"tmf-context-menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.hyperlink)}}),e("span",{staticClass:"tmf-context-menu__item__text"},[t._v("Insert Hyperlink")])])]):t._e(),"word"===t.$store.getters.hostType?e("li",{staticClass:"tmf-context-menu__item"},[e("a",{staticClass:"tmf-context-menu__item__link",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.insertIntoWrodDocument(n.data.bookmark)}}},[e("span",{staticClass:"tmf-context-menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.agreement)}}),e("span",{staticClass:"tmf-context-menu__item__text"},[t._v("Insert into document")])])]):t._e(),"word"===t.$store.getters.hostType&&t.wordDocumentSelectedRange.length?e("li",{staticClass:"tmf-context-menu__item"},[e("a",{staticClass:"tmf-context-menu__item__link",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.insertIntoWrodDocument(n.data.bookmark,"hyperlink")}}},[e("span",{staticClass:"tmf-context-menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.hyperlink)}}),e("span",{staticClass:"tmf-context-menu__item__text"},[t._v("Insert into document as Hyperlink")])])]):t._e(),"TeamsExtension"===t.$route.matched[0].name?e("li",{staticClass:"tmf-context-menu__item"},[e("a",{staticClass:"tmf-context-menu__item__link",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.insertIntoTeamsChat(n.data.bookmark)}}},[e("span",{staticClass:"tmf-context-menu__item__icon",domProps:{innerHTML:t._s(t.$internalIcons.addToChat)}}),e("span",{staticClass:"tmf-context-menu__item__text"},[t._v("Insert into chat")])])]):t._e()]:void 0}}],null,!0)})},o=[],i=n("e687"),a=n("899b"),l=n("2f62"),c={mixins:[i["a"]],data(){return{actions:{},componentData:{},currentComponentData:{},bookmark:{}}},computed:{...Object(l["b"])(["hostType","wordDocumentSelectedRange","selectedCollection"]),isTrashed(){var t;return null===(t=this.bookmark)||void 0===t?void 0:t.isDeleted}},components:{VueContext:a["a"]},methods:{open(t,e){this.actions={...e.actions},this.componentData={...null===e||void 0===e?void 0:e.actions},this.currentComponentData={...e.componentData},this.bookmark={...e.bookmark},this.$refs.bookmarkMenu.open(t,e)}}},r=c,m=n("2877"),u=Object(m["a"])(r,s,o,!1,null,null,null);e["default"]=u.exports},"899b":function(t,e,n){"use strict";n.d(e,"a",(function(){return w}));var s=n("2b0e"),o="2.2.2",i=/^2\./.test(s["a"].version);i||s["a"].util.warn("VueClickaway "+o+" only supports Vue 2.x, and does not support Vue "+s["a"].version);var a="_vue_clickaway_handler";function l(t,e,n){c(t);var s=n.context,o=e.value;if("function"===typeof o){var i=!1;setTimeout((function(){i=!0}),0),t[a]=function(e){var n=e.path||(e.composedPath?e.composedPath():void 0);if(i&&(n?n.indexOf(t)<0:!t.contains(e.target)))return o.call(s,e)},document.documentElement.addEventListener("click",t[a],!1)}}function c(t){document.documentElement.removeEventListener("click",t[a],!1),delete t[a]}var r={bind:l,update:function(t,e){e.value!==e.oldValue&&l(t,e)},unbind:c};Array.from||(Array.from=t=>[].slice.call(t)),Array.isArray||(Array.isArray=t=>"[object Array]"===Object.prototype.toString.call(t));const m=Array.from,u=Array.isArray,d={ESC:27,LEFT:37,UP:38,RIGHT:39,DOWN:40},h=(t,e)=>!(!t||"function"!==typeof t.contains)&&t.contains(e),_=(t,e,n)=>{t&&t.addEventListener&&t.addEventListener(e,n)},p=(t,e,n)=>{t&&t.removeEventListener&&t.removeEventListener(e,n)},f=t=>(t||[]).filter(v),k=t=>b(t)?t.getBoundingClientRect():null,b=t=>Boolean(t&&t.nodeType===Node.ELEMENT_NODE),v=t=>{if(!b(t)||!h(document.body,t))return!1;if("none"===t.style.display)return!1;const e=k(t);return Boolean(e&&e.height>0&&e.width>0)},x=(t,e)=>m((b(e)?e:document).querySelectorAll(t)),y=(t,e,n)=>{e&&b(t)&&t.setAttribute(e,n)},$=(t,e)=>{let n=t.parentElement;while(null!==n&&!n.classList.contains(e))n=n.parentElement;return n},C=(t,e={},n={},s={})=>{const o=n[t]||s[t];return"function"===typeof o?o(e):o};var w={directives:{onClickaway:r},props:{closeOnClick:{type:Boolean,default:!0},closeOnScroll:{type:Boolean,default:!0},lazy:{type:Boolean,default:!1},itemSelector:{type:[String,Array],default:()=>[".v-context-item",".v-context > li > a"]},role:{type:String,default:"menu"},subMenuOffset:{type:Number,default:10},useScrollHeight:{type:Boolean,default:!1},useScrollWidth:{type:Boolean,default:!1},heightOffset:{type:Number,default:25},widthOffset:{type:Number,default:25},tag:{type:String,default:"ul"}},computed:{style(){return this.show?{top:this.top+"px",left:this.left+"px"}:null}},data(){return{top:null,left:null,show:!1,data:null,localItemSelector:"",activeSubMenu:null}},created(){this.localItemSelector=this.mapItemSelector(this.itemSelector)},beforeDestroy(){this.closeOnScroll&&this.removeScrollEventListener()},methods:{addScrollEventListener(){_(window,"scroll",this.close)},addHoverEventListener(t){t.querySelectorAll(".v-context__sub").forEach(t=>{_(t,"mouseenter",this.openSubMenu),_(t,"mouseleave",this.closeSubMenu)})},close(){if(this.show){while(null!==this.activeSubMenu)$(this.activeSubMenu,"v-context__sub").dispatchEvent(new Event("mouseleave"));this.resetData(),this.removeHoverEventListener(this.$el),this.closeOnScroll&&this.removeScrollEventListener(),this.$emit("close")}},focusItem(t,e){const n=e.find((e,n)=>n===t);n&&n.focus()},focusNext(t,e){this.show&&(t.preventDefault(),t.stopPropagation(),this.$nextTick(()=>{const n=this.getItems();if(n.length<1)return;let s=n.indexOf(t.target);e&&s>0?s--:!e&&s<n.length-1&&s++,s<0&&(s=0),this.focusItem(s,n)}))},getItems(){return f(x(this.localItemSelector,this.activeSubMenu||this.$el))},mapItemSelector(t){return u(t)&&(t=t.map(t=>t+":not(.disabled):not([disabled])").join(", ")),t},onClick(){this.close()},onKeydown(t){const e=t.keyCode;if(e===d.ESC)this.close();else if(e===d.DOWN)this.focusNext(t,!1);else if(e===d.UP)this.focusNext(t,!0);else if(e===d.RIGHT){const e=$(t.target,"v-context__sub");e&&e.getElementsByClassName("v-context")[0]!==this.activeSubMenu&&(e.dispatchEvent(new Event("mouseenter")),this.focusNext(t,!1))}else if(e===d.LEFT){if(!this.activeSubMenu)return;const t=$(this.activeSubMenu,"v-context__sub");t.dispatchEvent(new Event("mouseleave"));const e=this.getItems(),n=e.indexOf(t.getElementsByTagName("a")[0]);this.focusItem(n,e)}},open(t,e){this.data=e,this.show=!0,this.$nextTick(()=>{[this.top,this.left]=this.positionMenu(t.clientY,t.clientX,this.$el),this.$el.focus(),this.setItemRoles(),this.addHoverEventListener(this.$el),this.closeOnScroll&&this.addScrollEventListener(),this.$emit("open",t,this.data,this.top,this.left)})},openSubMenu(t){const e=this.getSubMenuElementByEvent(t),n=$(e.parentElement,"v-context"),s=k(t.target);if(this.activeSubMenu!==n)while(null!==this.activeSubMenu&&this.activeSubMenu!==n&&this.activeSubMenu!==e)$(this.activeSubMenu,"v-context__sub").dispatchEvent(new Event("mouseleave"));e.style.display="block";let[o,i]=this.positionMenu(s.top,s.right-this.subMenuOffset,e);e.style.left=i+"px",e.style.top=o+"px",this.activeSubMenu=e},closeSubMenu(t){const e=this.getSubMenuElementByEvent(t),n=$(e,"v-context");if(this.activeSubMenu!==e)while(null!==this.activeSubMenu&&this.activeSubMenu!==e)$(this.activeSubMenu,"v-context__sub").dispatchEvent(new Event("mouseleave"));e.style.display="none",this.activeSubMenu=n&&$(n,"v-context__sub")?n:null},getSubMenuElementByEvent(t){return t.target.getElementsByTagName("ul")[0]},positionMenu(t,e,n){const s=this.useScrollHeight?n.scrollHeight:n.offsetHeight,o=window.innerHeight-s-this.heightOffset,i=this.useScrollWidth?n.scrollWidth:n.offsetWidth,a=window.innerWidth-i-this.widthOffset;return t>o&&(t=o),e>a&&(e=a),[t,e]},removeScrollEventListener(){p(window,"scroll",this.close)},removeHoverEventListener(t){t.querySelectorAll(".v-context__sub").forEach(t=>{p(t,"mouseenter",this.openSubMenu),p(t,"mouseleave",this.closeSubMenu)})},resetData(){this.top=null,this.left=null,this.data=null,this.show=!1},setItemRoles(){x(this.localItemSelector,this.$el).forEach(t=>{y(t,"role","menuitem"),y(t,"tabindex","-1")})}},watch:{closeOnScroll(t,e){t!==e&&(t&&this.show?this.addScrollEventListener():this.removeScrollEventListener())},itemSelector(t,e){t!==e&&(this.localItemSelector=this.mapItemSelector(t))}},render(t){if(this.lazy&&!this.show)return t(!1);const e={"!contextmenu":t=>{t.preventDefault()},keydown:this.onKeydown};this.closeOnClick&&(e.click=this.onClick);const n=[{name:"on-clickaway",value:this.close,rawName:"v-on-clickaway"}];return this.lazy||n.push({name:"show",value:this.show,rawName:"v-show",expression:"show"}),t(this.tag,{staticClass:"v-context",style:this.style,attrs:{tabindex:"-1",role:this.role,"aria-hidden":this.lazy?null:String(!this.show)},on:e,directives:n},[C("default",{data:this.data},this.$scopedSlots,this.$slots)])}}},e687:function(t,e,n){"use strict";var s=n("2f62");e["a"]={computed:{...Object(s["b"])(["searchedBookmarks","wordDocumentSelectedRange","selectedCollection","bookmarks"])},methods:{openLinkInNewTab(t,e="current"){if("current"===e)window.open(t.path,"_blank");else if("private"===e){let e=this.$store.getters.extensionId;if(!e)return;window.chrome.windows.create({url:t.path,incognito:!0})}},openEmailInNewTab(t){window.open("mailto:"+t.path)},copyLinkHandler(t){this.$bus.$emit("copy-bookmark",[t.id])},copyBookmarkLink(t){const e=document.createElement("textarea");e.value=t.path,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),this.$bus.$emit("open-toaster","Link copied")},viewBookmarkQRCode(t){this.$bus.$emit("open-qr-modal",t.path)},editBookmark(t){this.$bus.$emit("open-bookmark-form",t)},checkForLinkTag(t,e){this.$parent.$refs["link-tag-"+t.id][0].initialize({bookmark:t,index:e,storeInfo:this.componentData})},async trashBookmark(t){this.$bus.$emit("dialog-open",`Do you want to move <b>${t.title}</b> Link to trash?`),this.$bus.$on("dialog-success",e=>{e&&this.trashBookmarkApi(t),this.$bus.$off("dialog-success")})},async trashBookmarkApi(t){var e,n;let s=this,o={...t,isDeleted:!0,Type:1,title:t.title,description:t.description};this.$bus.$emit("open-toaster",`<small>Trashing Link <strong>${t.title}</strong></small>`,"loader");let i={};if(await s.$axios.put("/bookmark/"+t.id,o).then(e=>{i=e,this.$bus.$emit("open-toaster",`<b>Link Trashed</b> <small><strong>${t.title}</strong> link has been added to trash.</small>`,"success")}).catch(()=>{this.$bus.$emit("open-toaster",`<b>Error Trashing</b> <small><strong>${t.title}</strong> failed to trash.</small>`,"error")}),null!==t&&void 0!==t&&t.isSearch){let e=this.searchedBookmarks.filter(({...e})=>e.id!==t.id);this.$store.commit("SET_SEARCHED_BOOKMARKS",e)}else if(null!==t&&void 0!==t&&t.isSearch||+(null===(e=this.$route.params)||void 0===e?void 0:e.collectionId)!==(null===t||void 0===t?void 0:t.categoryID)){if(null!==(n=this.$route.meta)&&void 0!==n&&n.allBookmarks){let e=this.bookmarks.filter(({...e})=>e.id!==t.id);this.$store.commit("SET_BOOKMARKS",e)}}else{let t=this.selectedCollection;t.bookmarkCount-=1,this.$collectionHelper.mapCollection({collection:t,componentData:this.$collectionHelper.getNavItemComponentData(t),type:"update"})}this.$helper.setState("delete",this.componentData.mutation,this.componentData.getter,i.data,null,this.componentData.mutationImage,this.componentData.getterImage),this.$helper.setState("add","SET_TRASHED_BOOKMARKS","trashedBookmarks",i.data,null,this.componentData.mutationImage,this.componentData.getterImage)},async untrashBookmark(t){this.$bus.$emit("dialog-open",`Do you want to untrash ${t.title} Link?`),this.$bus.$on("dialog-success",e=>{e&&this.untrashBookmarkApi(t),this.$bus.$off("dialog-success")})},async untrashBookmarkApi(t){let e={...t,isDeleted:!1,Type:1,title:t.title,description:t.description},n=await this.$axios.put("/bookmark/"+t.id,e);this.$bus.$emit("open-toaster",`<b>${t.title}</b> bookmark moved from trash.`),this.$helper.setState("delete",this.componentData.mutation,this.componentData.getter,n.data,null,this.componentData.mutationImage,this.componentData.getterImage),await this.$store.dispatch("getCollections")},async deleteBookmark(t){this.$bus.$emit("dialog-open",`Do you want to permanently delete <b>${t.title}</b> Link ?`),this.$bus.$on("dialog-success",e=>{e&&this.deleteBookmarkApi(t),this.$bus.$off("dialog-success")})},async deleteBookmarkApi(t){await this.$axios.delete("/bookmark/"+t.id),this.$bus.$emit("open-toaster",`<b>${t.title}</b> bookmark deleted.`),this.$helper.setState("delete",this.componentData.mutation,this.componentData.getter,t,null,this.componentData.mutationImage,this.componentData.getterImage)},insertIntoEmail(t){this.insertBookmarksIntoEmail(t.path)},insertBookmarksIntoEmail(t){let e=window.Office.context.mailbox.item;e.body.getTypeAsync((function(n){n.status==window.Office.AsyncResultStatus.Failed||(n.value==window.Office.MailboxEnums.BodyType.Html?e.body.setSelectedDataAsync(`<a href="${t}">${t}</a>`,{coercionType:window.Office.CoercionType.Html},(function(t){t.status,window.Office.AsyncResultStatus.Failed})):e.body.setSelectedDataAsync(t,{coercionType:window.Office.CoercionType.Text,asyncContext:{var3:1,var4:2}},(function(t){t.status,window.Office.AsyncResultStatus.Failed})))}))},insertIntoWrodDocument(t,e){const n=`<a href="${t.path}" target="_blank">${"hyperlink"===e?this.wordDocumentSelectedRange:t.path}</a>`;let s=this;window.Office.context.document.setSelectedDataAsync(n,{coercionType:"html"},(function(t){t.status,window.Office.AsyncResultStatus.Failed,s.$store.commit("SET_WORD_SELECTED_RANGE","")}))},insertHyperlink(t){let e=this;window.Office.context.mailbox.item.getSelectedDataAsync(window.Office.CoercionType.Text,{},(function(n){var s;let o=null===(s=n.value)||void 0===s?void 0:s.data;o?window.Office.context.mailbox.item.body.setSelectedDataAsync(`<a href="${t.path}" target="_blank">${o}</a>`,{coercionType:window.Office.CoercionType.Html},(function(t){t.status!=window.Office.AsyncResultStatus.Failed&&e.$bus.$emit("open-toaster","Hyperlink added to email.")})):(e.$bus.$emit("dialog-open","Please select a text first to add hyperlink."),e.$bus.$on("dialog-success",()=>{e.$bus.$off("dialog-success")}))}))},insertIntoTeamsChat(t){this.$microsoftTeams.dialog.url.submit({title:t.title,path:t.path})},async pinBookmarkHandler(t){try{this.pinningBookmarkId=t.id;let e={...t,isPinned:!t.isPinned};await this.$axios.put("/bookmark/"+t.id,e).then(()=>{this.$bus.$emit("open-toaster",`<b>Link ${t.isPinned?"unpinned":"pinned"} </b><small>Link <strong>${t.title}</strong> has been ${t.isPinned?"unpinned":"pinned"} successfully</small>`,"success")}).catch(()=>{this.$bus.$emit("open-toaster",`<b>Error ${t.isPinned?"unpinning":"pinning"} </b><small>Error  ${t.isPinned?"unpinning":"pinning"} <strong>${t.title}</strong> link.</small>`,"error")}),t.isPinned=!t.isPinned;let n=this.componentData.mutation,s=this.componentData.getter;Object.keys(this.$route.meta).includes("allBookmarks")&&(n="SET_BOOKMARKS",s="bookmarks"),this.$helper.setState("edit",n,s,t,null,this.componentData.mutationImage,this.componentData.getterImage)}finally{this.pinningBookmarkId=null}}}}}}]);